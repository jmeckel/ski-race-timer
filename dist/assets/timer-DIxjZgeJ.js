var G=Object.defineProperty;var Z=(i,t,e)=>t in i?G(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var a=(i,t,e)=>Z(i,typeof t!="symbol"?t+"":t,e);import{w as _,L as K,u as E,s as l,t as y,a9 as J,aa as tt,ab as et,p as d,ac as it,d as v,l as nt,N as st,ad as at,R as ot,_ as X,a as rt,h as Y,f as ct,ae as lt,af as dt,E as ut,ag as ht,ah as mt,ai as ft,aj as gt,ak as bt,al as pt,$ as yt,am as vt}from"./chief-judge-riJEdY3M.js";import{m as D}from"./vendor-signals-BA-R9xnX.js";class St{constructor(t,e){a(this,"callbacks");a(this,"config");a(this,"rotation",0);a(this,"velocity",0);a(this,"accumulatedRotation",0);a(this,"spinAnimationId",null);a(this,"snapBackAnimationId",null);a(this,"snapBackTimeoutId",null);a(this,"visualTimeoutIds",new Set);a(this,"frameCount",0);a(this,"isDestroyed",!1);a(this,"prefersReducedMotion",!1);a(this,"motionMediaQuery",null);a(this,"visibilityHandler",null);a(this,"onMotionPreferenceChange",t=>{this.prefersReducedMotion=t.matches,this.prefersReducedMotion&&(this.cancelAllAnimations(),this.rotation!==0&&(this.rotation=0,this.callbacks.onRotationUpdate(0),this.callbacks.onAnimationComplete()))});a(this,"spinWithMomentum",()=>{if(Math.abs(this.velocity)<.2){this.velocity=0,this.callbacks.onAnimationComplete(),this.scheduleSnapBack();return}this.rotation+=this.velocity,this.accumulatedRotation+=this.velocity,this.velocity*=this.config.friction,this.shouldSkipFrame()||this.callbacks.onRotationUpdate(this.rotation),this.checkDigitChange(),this.spinAnimationId!==null&&cancelAnimationFrame(this.spinAnimationId),this.spinAnimationId=requestAnimationFrame(this.spinWithMomentum)});a(this,"snapBack",()=>{if(Math.abs(this.rotation)<1){this.rotation=0,this.callbacks.onRotationUpdate(this.rotation),this.snapBackAnimationId=null,this.callbacks.onAnimationComplete();return}this.rotation*=1-.15,this.shouldSkipFrame()||this.callbacks.onRotationUpdate(this.rotation),this.snapBackAnimationId=requestAnimationFrame(this.snapBack)});this.callbacks=t,this.config=e,typeof window<"u"&&window.matchMedia&&(this.motionMediaQuery=window.matchMedia("(prefers-reduced-motion: reduce)"),this.prefersReducedMotion=this.motionMediaQuery.matches,this.motionMediaQuery.addEventListener("change",this.onMotionPreferenceChange)),this.visibilityHandler=()=>{document.hidden&&this.cancelAllAnimations()},document.addEventListener("visibilitychange",this.visibilityHandler)}getRotation(){return this.rotation}getVelocity(){return this.velocity}onDragStart(){this.cancelAllAnimations(),this.velocity=0,this.accumulatedRotation=0}onDragMove(t,e){this.velocity=t/e*16*this.config.momentum,this.rotation+=t,this.accumulatedRotation+=t,this.callbacks.onRotationUpdate(this.rotation),this.checkDigitChange()}startMomentumSpin(){if(this.prefersReducedMotion){this.processDigitChangesInstantly(),this.velocity=0,this.rotation=0,this.callbacks.onRotationUpdate(0),this.callbacks.onAnimationComplete();return}this.spinWithMomentum()}onDragEndNoMomentum(){if(this.prefersReducedMotion){this.rotation=0,this.callbacks.onRotationUpdate(0),this.callbacks.onAnimationComplete();return}this.scheduleSnapBack()}pauseAnimations(){this.cancelAllAnimations()}flash(t,e){if(this.prefersReducedMotion)return;t==null||t.classList.add("flash"),e==null||e.querySelectorAll(".dial-number").forEach((s,o)=>{const r=window.setTimeout(()=>{this.visualTimeoutIds.delete(r),s.classList.add("flash");const u=window.setTimeout(()=>{s.classList.remove("flash"),this.visualTimeoutIds.delete(u)},200);this.visualTimeoutIds.add(u)},o*40);this.visualTimeoutIds.add(r)});const n=window.setTimeout(()=>{t==null||t.classList.remove("flash"),this.visualTimeoutIds.delete(n)},1200);this.visualTimeoutIds.add(n)}flashDigit(t){this.prefersReducedMotion||this.flashClass(t,"flash",150)}flashPressed(t){this.prefersReducedMotion||this.flashClass(t,"pressed",150)}destroy(){var t;if(!this.isDestroyed){this.isDestroyed=!0,this.cancelAllAnimations();for(const e of this.visualTimeoutIds)clearTimeout(e);this.visualTimeoutIds.clear(),(t=this.motionMediaQuery)==null||t.removeEventListener("change",this.onMotionPreferenceChange),this.motionMediaQuery=null,this.visibilityHandler&&(document.removeEventListener("visibilitychange",this.visibilityHandler),this.visibilityHandler=null)}}processDigitChangesInstantly(){let t=this.velocity,e=this.accumulatedRotation;for(;Math.abs(t)>=.2;)for(e+=t,t*=this.config.friction;Math.abs(e)>=this.config.sensitivity;){const n=e>0?1:-1;this.callbacks.onDigitChange(n),e-=n*this.config.sensitivity}this.accumulatedRotation=e}cancelAllAnimations(){this.spinAnimationId&&(cancelAnimationFrame(this.spinAnimationId),this.spinAnimationId=null),this.snapBackAnimationId&&(cancelAnimationFrame(this.snapBackAnimationId),this.snapBackAnimationId=null),this.snapBackTimeoutId&&(clearTimeout(this.snapBackTimeoutId),this.snapBackTimeoutId=null)}flashClass(t,e,n){t.classList.add(e);const s=window.setTimeout(()=>{t.classList.remove(e),this.visualTimeoutIds.delete(s)},n);this.visualTimeoutIds.add(s)}shouldSkipFrame(){this.frameCount++;const t=_.getStatus().batteryLevel;return t==="low"?this.frameCount%2!==0:t==="critical"?this.frameCount%4!==0:!1}scheduleSnapBack(){this.snapBackTimeoutId&&clearTimeout(this.snapBackTimeoutId),this.snapBackTimeoutId=window.setTimeout(()=>{this.snapBack()},800)}checkDigitChange(){if(Math.abs(this.accumulatedRotation)>=this.config.sensitivity){const t=this.accumulatedRotation>0?1:-1;this.callbacks.onDigitChange(t),this.accumulatedRotation=this.accumulatedRotation%this.config.sensitivity}}}class kt{constructor(t,e){a(this,"container");a(this,"callbacks");a(this,"listeners",new K);a(this,"isDragging",!1);a(this,"lastAngle",0);a(this,"lastDragTime",0);a(this,"dragStartPos",null);a(this,"hasDraggedSignificantly",!1);a(this,"lastTouchTime",0);a(this,"isDestroyed",!1);a(this,"handleDragStart",t=>{const e="touches"in t;if(!e&&Date.now()-this.lastTouchTime<500)return;e&&(this.lastTouchTime=Date.now());const n=this.container.getBoundingClientRect(),s=e?t.touches[0].clientX:t.clientX,o=e?t.touches[0].clientY:t.clientY,r=n.left+n.width/2,u=n.top+n.height/2,f=Math.sqrt((s-r)**2+(o-u)**2);f<n.width*.27||f>n.width*.5||(this.callbacks.onDragStart(),this.dragStartPos={x:s,y:o},this.hasDraggedSignificantly=!1,this.isDragging=!0,this.lastAngle=this.getAngle(s,o,n),this.lastDragTime=Date.now())});a(this,"handleDragMove",t=>{if(!this.isDragging)return;const e="touches"in t?t.touches[0].clientX:t.clientX,n="touches"in t?t.touches[0].clientY:t.clientY;if(this.dragStartPos&&!this.hasDraggedSignificantly)if(Math.sqrt((e-this.dragStartPos.x)**2+(n-this.dragStartPos.y)**2)>10)this.hasDraggedSignificantly=!0;else return;t.preventDefault();const s=this.container.getBoundingClientRect(),o=this.getAngle(e,n,s);let r=o-this.lastAngle;r>180&&(r-=360),r<-180&&(r+=360);const u=Date.now(),f=Math.max(u-this.lastDragTime,1);this.callbacks.onDragMove(r,f),this.lastAngle=o,this.lastDragTime=u});a(this,"handleDragEnd",()=>{if(this.isDragging){if(this.isDragging=!1,!this.hasDraggedSignificantly&&this.dragStartPos){this.detectNumberTap(),this.dragStartPos=null,this.callbacks.onDragEndAsTap();return}this.dragStartPos=null,Math.abs(this.callbacks.getVelocity())>.5?this.callbacks.onDragEndWithMomentum():this.callbacks.onDragEndCommon()}});this.container=t,this.callbacks=e}bindEvents(){this.listeners.add(this.container,"mousedown",this.handleDragStart),this.listeners.add(window,"mousemove",this.handleDragMove),this.listeners.add(window,"mouseup",this.handleDragEnd),this.listeners.add(this.container,"touchstart",this.handleDragStart,{passive:!1}),this.listeners.add(this.container,"touchmove",this.handleDragMove,{passive:!1}),this.listeners.add(this.container,"touchend",this.handleDragEnd)}getDragState(){return{isDragging:this.isDragging,hasDraggedSignificantly:this.hasDraggedSignificantly}}destroy(){this.isDestroyed||(this.isDestroyed=!0,this.listeners.removeAll())}detectNumberTap(){if(!this.dragStartPos)return;const t=this.container.getBoundingClientRect(),e=t.left+t.width/2,n=t.top+t.height/2;let s=Math.atan2(this.dragStartPos.y-n,this.dragStartPos.x-e)*(180/Math.PI);s-=this.callbacks.getRotation(),s=(s%360+360)%360;const o=[1,2,3,4,5,6,7,8,9,0];let r=0,u=360;o.forEach((f,g)=>{const h=(g*36-90+360)%360;let m=Math.abs(s-h);m>180&&(m=360-m),m<u&&m<20&&(u=m,r=f)}),u<20&&this.callbacks.onNumberTap(r)}getAngle(t,e,n){const s=n.left+n.width/2,o=n.top+n.height/2;return Math.atan2(e-o,t-s)*(180/Math.PI)}}class Tt{constructor(t,e={}){a(this,"container");a(this,"dialNumbers",null);a(this,"dialRing",null);a(this,"options");a(this,"interaction",null);a(this,"animation");a(this,"resizeObserver",null);a(this,"lastContainerWidth",0);a(this,"numberKeydownListeners",new Map);a(this,"cachedNumberSpans",[]);a(this,"cachedNumberElements",new Map);a(this,"isDestroyed",!1);a(this,"visibilityHandler",null);a(this,"bibValue","");this.container=t,this.options={onChange:e.onChange||(()=>{}),momentum:e.momentum??1.5,friction:e.friction??.97,sensitivity:e.sensitivity??24},this.animation=new St({onRotationUpdate:n=>this.updateDialRotation(n),onDigitChange:n=>this.adjustBib(n),onAnimationComplete:()=>{var n;return(n=this.dialNumbers)==null?void 0:n.classList.remove("momentum")}},{momentum:this.options.momentum,friction:this.options.friction,sensitivity:this.options.sensitivity}),this.init()}init(){if(this.dialNumbers=this.container.querySelector(".dial-numbers"),this.dialRing=this.container.querySelector(".dial-ring"),!this.dialNumbers){E.warn("[RadialDial] Required elements not found");return}this.generateDialNumbers(),this.generateTicks(),this.bindEvents()}generateDialNumbers(){if(!this.dialNumbers)return;this.dialNumbers.innerHTML="",this.cachedNumberSpans=[],this.cachedNumberElements.clear();const t=[1,2,3,4,5,6,7,8,9,0],e=this.container.offsetWidth||460,n=e*.38,s=e/2;t.forEach((o,r)=>{const u=(r*36-90)*(Math.PI/180),f=s+n*Math.cos(u),g=s+n*Math.sin(u),h=document.createElement("div");h.className="dial-number",h.dataset.num=String(o),h.innerHTML=`<span>${o}</span>`,h.style.left=`${f}px`,h.style.top=`${g}px`,h.style.transform="translate(-50%, -50%)";const m=l.getState().currentLang;h.setAttribute("tabindex","0"),h.setAttribute("role","button"),h.setAttribute("aria-label",`${y("numberLabel",m)} ${o}`);const p=b=>{const I=b;(I.key==="Enter"||I.key===" ")&&(I.preventDefault(),this.handleNumberTap(o,h))};h.addEventListener("keydown",p),this.numberKeydownListeners.set(h,p),this.dialNumbers.appendChild(h);const S=h.querySelector("span");S&&this.cachedNumberSpans.push(S),this.cachedNumberElements.set(String(o),h)})}generateTicks(){const t=this.container.querySelector(".dial-ticks");if(t){t.innerHTML="";for(let e=0;e<60;e++){const n=document.createElement("div");n.className=`dial-tick${e%6===0?" major":""}`,n.style.transform=`rotate(${e*6}deg)`,t.appendChild(n)}}}handleNumberTap(t,e){this.bibValue.length<3&&(this.bibValue+=String(t),this.options.onChange(this.bibValue),J(),this.animation.flashPressed(e))}bindEvents(){this.interaction=new kt(this.container,{onDragStart:()=>{var t,e;this.animation.onDragStart(),(t=this.dialNumbers)==null||t.classList.remove("momentum"),(e=this.dialNumbers)==null||e.classList.add("momentum")},onNumberTap:t=>{var n;const e=(n=this.dialNumbers)==null?void 0:n.querySelector(`[data-num="${t}"]`);e&&this.handleNumberTap(t,e)},onDragMove:(t,e)=>{this.animation.onDragMove(t,e)},onDragEndWithMomentum:()=>{this.animation.startMomentumSpin()},onDragEndAsTap:()=>{var t;(t=this.dialNumbers)==null||t.classList.remove("momentum")},onDragEndCommon:()=>{var t;(t=this.dialNumbers)==null||t.classList.remove("momentum"),this.animation.onDragEndNoMomentum()},getRotation:()=>this.animation.getRotation(),getVelocity:()=>this.animation.getVelocity()}),this.interaction.bindEvents(),this.visibilityHandler=()=>{document.hidden&&this.animation.pauseAnimations()},document.addEventListener("visibilitychange",this.visibilityHandler),this.lastContainerWidth=this.container.offsetWidth,this.resizeObserver=new ResizeObserver(t=>{const e=t[0];if(!e)return;const n=Math.round(e.contentRect.width);n>0&&n!==this.lastContainerWidth&&(this.lastContainerWidth=n,this.generateDialNumbers())}),this.resizeObserver.observe(this.container)}adjustBib(t){let e=parseInt(this.bibValue||"0",10);e+=t,e<0&&(e=0),e>999&&(e=999),this.bibValue=String(e),this.options.onChange(this.bibValue),tt();const n=String(e%10),s=this.cachedNumberElements.get(n);s&&this.animation.flashDigit(s)}updateDialRotation(t){if(!this.dialNumbers)return;this.dialNumbers.style.transform=`rotate(${t}deg)`;const e=`rotate(${-t}deg)`;for(const n of this.cachedNumberSpans)n.style.transform=e}getValue(){return this.bibValue}setValue(t){this.bibValue=t.slice(0,3)}clear(){this.bibValue=""}flash(){this.animation.flash(this.dialRing,this.dialNumbers)}updateAriaLabels(){const t=l.getState().currentLang;for(const[e,n]of this.cachedNumberElements)n.setAttribute("aria-label",`${y("numberLabel",t)} ${e}`)}destroy(){if(!this.isDestroyed){this.isDestroyed=!0,this.animation.destroy(),this.interaction&&(this.interaction.destroy(),this.interaction=null),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.visibilityHandler&&(document.removeEventListener("visibilitychange",this.visibilityHandler),this.visibilityHandler=null);for(const[t,e]of this.numberKeydownListeners)t.removeEventListener("keydown",e);this.numberKeydownListeners.clear()}}}function Dt(i){const{bib:t,point:e,run:n,deviceId:s,deviceName:o,gpsService:r}=i,u=r.getTimeOffset();let f,g;u!==null?(f=new Date(Date.now()+u).toISOString(),g="gps"):(f=new Date().toISOString(),g="system");const h=r.getCoordinates(),m=r.getTimestamp()??void 0;return{entry:{id:et(s),bib:t?t.padStart(3,"0"):"",point:e,run:n,timestamp:f,status:"ok",deviceId:s,deviceName:o,gpsCoords:h,timeSource:g,gpsTimestamp:m},timeSource:g}}function wt(i,t){return!!(i.bib&&t.some(e=>e.bib===i.bib&&e.point===i.point&&(e.run??1)===i.run))}function Ct(i){return i?/^0+$/.test(i):!1}const A=new K;let c=null,k=null,w=null,B=null,q=!1,z=[],C=null,W=[],O=[];function Pt(){if(!d("dial-container")){E.debug("[RadialTimerView] Dial container not found, skipping init");return}if(q){E.debug("[RadialTimerView] Already initialized");return}E.debug("[RadialTimerView] Initializing..."),At(),It(),Et(),Rt(),Mt(),Lt(),Nt(),V(),H(),N(),z=[D(()=>{ht.value,V()}),D(()=>{mt.value,H()}),D(()=>{ft.value,gt.value,H()}),D(()=>{bt.value,M()}),D(()=>{pt.value,x()}),D(()=>{yt.value,N()}),D(()=>{vt.value,V()})],A.add(window,"settings-language-changed",()=>{N(),c==null||c.updateAriaLabels()}),q=!0,E.debug("[RadialTimerView] Initialized successfully")}function At(){w&&(w(),w=null),k&&(k.destroy(),k=null);const i=d("radial-time-hm"),t=d("radial-time-seconds"),e=d("radial-time-subseconds");let n=d("clock-container");n||(n=document.createElement("div"),n.id="clock-container",n.style.display="none",document.body.appendChild(n)),k=new it(n),w=k.onTick((g,h,m,p)=>{B||(i&&(i.textContent=`${g}:${h}`),t&&(t.textContent=m),e&&(e.textContent=p))});const s=new Date,o=String(s.getHours()).padStart(2,"0"),r=String(s.getMinutes()).padStart(2,"0"),u=String(s.getSeconds()).padStart(2,"0"),f=String(s.getMilliseconds()).padStart(3,"0");i&&(i.textContent=`${o}:${r}`),t&&(t.textContent=u),e&&(e.textContent=f),k.start()}function It(){const i=d("dial-container");if(!i)return;c&&c.destroy(),c=new Tt(i,{onChange:e=>{l.setBibInput(e),T(e)},momentum:1.5,friction:.97,sensitivity:24});const t=l.getState();t.bibInput&&(c.setValue(t.bibInput),T(t.bibInput))}function T(i){const t=d("radial-bib-value");t&&(i?(t.textContent=i.padStart(3,"0"),t.classList.add("active")):(t.textContent="---",t.classList.remove("active")))}function Et(){const i=d("radial-timing-point");i&&(A.add(i,"click",t=>{const n=t.target.closest(".radial-point-btn");if(!n)return;const s=n.getAttribute("data-point");s&&(l.setSelectedPoint(s),v(),M())}),W=Array.from(document.querySelectorAll(".radial-point-btn")),M())}function M(){const i=l.getState();W.forEach(t=>{const e=t.getAttribute("data-point")===i.selectedPoint;t.classList.toggle("active",e),t.setAttribute("aria-checked",String(e))})}function Rt(){const i=d("radial-run-selector");i&&(A.add(i,"click",t=>{const n=t.target.closest(".radial-run-btn");if(!n)return;const s=n.getAttribute("data-run");if(s){const o=parseInt(s,10);l.setSelectedRun(o),v(),x()}}),O=Array.from(document.querySelectorAll(".radial-run-btn")),x())}function x(){const i=l.getState();O.forEach(t=>{const n=t.getAttribute("data-run")===String(i.selectedRun);t.classList.toggle("active",n),t.setAttribute("aria-checked",String(n))})}function Mt(){const i=d("radial-time-btn");i&&A.add(i,"click",Q)}function Lt(){const i=d("radial-clear-btn");i&&A.add(i,"click",()=>{c==null||c.clear(),l.setBibInput(""),T(""),v(),i.classList.add("flash"),setTimeout(()=>i.classList.remove("flash"),150)})}function Nt(){A.add(document,"keydown",(i=>{var n;const t=(n=document.activeElement)==null?void 0:n.tagName,e=l.getState();if(!(t==="INPUT"||t==="TEXTAREA"||t==="SELECT")&&e.currentView==="timer"){if(/^[0-9]$/.test(i.key)){i.preventDefault();const s=e.bibInput;if(s.length<3){const o=s+i.key;l.setBibInput(o),c==null||c.setValue(o),T(o),v()}return}if(i.key==="Backspace"){i.preventDefault();const s=e.bibInput.slice(0,-1);l.setBibInput(s),c==null||c.setValue(s),T(s),v();return}if(i.key==="Delete"||i.key==="Escape"){i.preventDefault(),c==null||c.clear(),l.setBibInput(""),T(""),v();return}if(i.key==="s"||i.key==="S"){i.preventDefault(),l.setSelectedPoint("S"),v(),M();return}if(i.key==="f"||i.key==="F"){i.preventDefault(),l.setSelectedPoint("F"),v(),M();return}if(i.altKey&&(i.code==="Digit1"||i.code==="Digit2")){i.preventDefault();const s=i.code==="Digit1"?1:2;l.setSelectedRun(s),v(),x();return}if(i.key===" "||i.key==="Enter"){i.preventDefault(),Q();return}}}))}async function Q(){if(st.wasRecentlyExited()){v();return}const i=l.getState();if(i.isRecording)return;const{entry:t}=Dt({bib:i.bibInput,point:i.selectedPoint,run:i.selectedRun,deviceId:i.deviceId,deviceName:i.deviceName,gpsService:dt});l.setRecording(!0);try{i.settings.photoCapture&&at().then(async s=>{if(s){if(!l.getState().entries.some(r=>r.id===t.id))return;try{await ot.savePhoto(t.id,s)&&l.updateEntry(t.id,{photo:"indexeddb"})}catch(r){X("Camera","photo save",r,"photoError")}}}).catch(s=>{if(s instanceof Error&&s.name==="PhotoTooLargeError"){const o=l.getState().currentLang;rt(y("photoTooLarge",o),"warning")}else X("Camera","captureTimingPhoto",s,"photoError")});const e=wt(t,i.entries),n=Ct(t.bib);if(l.addEntry(t),e?(Y(),P(t,"duplicate")):n?(Y(),P(t,"zeroBib")):(ct(),P(t)),lt(t).catch(s=>{E.error("syncEntry failed:",s)}),i.settings.auto&&i.bibInput){const s=parseInt(i.bibInput,10)+1,o=Math.min(i.settings.sync&&i.cloudHighestBib>0?Math.max(s,i.cloudHighestBib+1):s,999),r=String(o);l.setBibInput(r),c==null||c.setValue(r),T(r)}else i.bibInput&&!i.settings.auto&&(l.setBibInput(""),c==null||c.clear(),T(""));N()}finally{l.setRecording(!1)}}function P(i,t){const e=new Date(i.timestamp),n=String(e.getHours()).padStart(2,"0"),s=String(e.getMinutes()).padStart(2,"0"),o=String(e.getSeconds()).padStart(2,"0"),r=String(e.getMilliseconds()).padStart(3,"0"),u=`${n}:${s}:${o}.${r}`;B=u;const f=d("radial-time-hm"),g=d("radial-time-seconds"),h=d("radial-time-subseconds");f&&(f.textContent=`${n}:${s}`),g&&(g.textContent=o),h&&(h.textContent=r);const m=d("dial-ring"),p=d("radial-time-display"),S=d("radial-time-btn");m==null||m.classList.add("flash"),p==null||p.classList.add("flash","frozen"),S==null||S.classList.add("flash"),c==null||c.flash();const b=d("radial-confirmation-overlay"),I=d("radial-confirm-bib"),F=d("radial-confirm-time"),$=d("radial-confirm-point");if(I&&(I.textContent=i.bib||"---"),F&&(F.textContent=u),$){const L=l.getState();$.textContent=ut(i.point,L.currentLang),$.className=`radial-confirmation-point ${i.point==="S"?"start":"finish"}`}const R=d("radial-confirm-warning"),U=d("radial-confirm-warning-text");if(R&&U)if(t){const L=l.getState();U.textContent=t==="duplicate"?y("duplicateWarning",L.currentLang):y("zeroBibWarning",L.currentLang),R.style.display="flex"}else R.style.display="none";b==null||b.classList.add("show"),b==null||b.setAttribute("aria-hidden","false"),C!==null&&clearTimeout(C);const j=t?2500:1200;C=window.setTimeout(()=>{C=null,B=null,m==null||m.classList.remove("flash"),p==null||p.classList.remove("flash","frozen"),S==null||S.classList.remove("flash"),b==null||b.classList.remove("show"),b==null||b.setAttribute("aria-hidden","true"),R&&(R.style.display="none")},j)}function V(){const i=l.getState(),t=d("radial-gps-status");if(!t)return;const e=t.querySelector(".radial-status-dot");e&&(i.settings.gps?i.gpsStatus==="active"?e.className="radial-status-dot":i.gpsStatus==="searching"?e.className="radial-status-dot warning":e.className="radial-status-dot inactive":e.className="radial-status-dot inactive")}function H(){const i=l.getState(),t=d("radial-sync-status");if(!t)return;if(!i.settings.sync){t.style.display="none";return}t.style.display="flex";const e=t.querySelector(".radial-status-dot"),n=t.querySelector(".radial-sync-text");if(e&&(i.syncStatus==="connected"?e.className="radial-status-dot":i.syncStatus==="error"?e.className="radial-status-dot error":e.className="radial-status-dot warning"),n){const s=i.cloudDeviceCount||0,o=i.currentLang;n.textContent=s>0?`${y("synced",o)} (${s})`:y("syncingStatus",o)}}function N(){const i=l.getState(),t=i.entries,e=d("radial-stats-count");if(e&&(e.textContent=`${t.length} ${t.length===1?y("entry",i.currentLang):y("entries",i.currentLang)}`),t.length>0){const n=t[t.length-1],s=d("radial-last-bib"),o=d("radial-last-point"),r=d("radial-last-time");if(s&&(s.textContent=n.bib||"---"),o&&(o.textContent=n.point==="S"?y("startShort",i.currentLang):y("finishShort",i.currentLang),o.className=`radial-stats-point ${n.point==="S"?"start":"finish"}`),r){const u=new Date(n.timestamp);r.textContent=nt(u)}}}function Vt(){for(const i of z)i();z=[],w&&(w(),w=null),k&&(k.destroy(),k=null),A.removeAll(),c&&(c.destroy(),c=null),C!==null&&(clearTimeout(C),C=null),B=null,q=!1,W=[],O=[]}function Ht(){const i=l.getState();T(i.bibInput),c==null||c.setValue(i.bibInput)}function qt(){const i=document.querySelector(".timer-view");return(i==null?void 0:i.classList.contains("radial-mode"))??!1}export{qt as a,Pt as b,Dt as c,Vt as d,wt as i,Ht as u};
